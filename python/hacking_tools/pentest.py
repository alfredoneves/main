#!/usr/bin/python3
# this program executes basic scans in an url and saves the results
# programs needed: whois, subfinder, nmap, gobuster
# attention to the wordlists used and to their path that can change

import subprocess

def exec_linux(command):
	"""
	Executes the linux command
	command:complete linux command to be executed
	"""
	proc = subprocess.Popen(command, shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
	result = (proc.stdout.read() + proc.stderr.read()).decode()
	return result
		
# name to the directory and target's url
print("pentest program, example of target: nmap.org")
url = input("target: ")	# definde the url of the target
name = f"recon_{url}"	# verify if the name already exists

# commands
whois = f"whois {url} >> {name}/whois_results.txt"	# whois lookup for the first domain
subfinder = f"subfinder -d {url} -o {name}/subfinder_results.txt"	# creates lists of subdomains
nmap = f"sudo nmap -A -v {url} -oN {name}/nmap_results.txt"	# problem executing nmap
gobuster = f"gobuster dir -w /usr/share/wordlists/dirb/big.txt -u {url} -t 16 -o {name}/gobuster_results.txt"

# list of commands that are going to me executed 
commands_list = [f"mkdir {name}", nmap, whois, subfinder, gobuster]

# executes the commands from the list
for command in commands_list:
	try:
		print(f"command beeing executed: {command}")
		exec_linux(command)
	except Exception as error:
		print(error)
print("finished")

